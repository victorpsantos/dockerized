---
- name: Load OS-Specific Vars
  ansible.builtin.include_vars:
    file: "{{ lookup('ansible.builtin.first_found', files, skip=true) }}"
  vars:
    files:
      - "{{ ansible_distribution | lower }}_{{ ansible_distribution_major_version }}.yml"
      - "{{ ansible_distribution | lower }}.yml"
      - "{{ ansible_os_family | lower }}_{{ ansible_distribution_major_version }}.yml"
      - "{{ ansible_os_family | lower }}.yml"

- name: Include Kernel Management Tasks
  ansible.builtin.include_tasks:
    file: kernel.yml

- name: Include Services Management Tasks
  ansible.builtin.include_tasks:
    file: services.yml

- name: Include Aptitude Management Tasks
  ansible.builtin.include_tasks:
    file: apt.yml

- name: Include AppArmor Management Tasks
  ansible.builtin.include_tasks:
    file: apparmor.yml
